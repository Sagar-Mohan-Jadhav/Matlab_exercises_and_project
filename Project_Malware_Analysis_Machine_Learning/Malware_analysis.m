% firsty, importing the required data.
data = readtable('data_5.dat');


%classification of data
classified_data = fitcknn(data, 'Var6', 'Distance','hamming');
%now comes division of data into testing and training sets.
cv = cvpartition(classified_data.NumObservations, 'KFold', 5);
%crossval function shows which data points are being used for testing and
%which for training.
cross_data = crossval(classified_data, 'cvpartition', cv);
%to see the data being chose for testing and training
predict_data1 = predict(cross_data.Trained{1}, data(test(cv, 1),1:end-1));
predict_data2 = predict(cross_data.Trained{2}, data(test(cv, 2),1:end-1));
predict_data3 = predict(cross_data.Trained{3}, data(test(cv, 3),1:end-1));
predict_data4 = predict(cross_data.Trained{4}, data(test(cv, 4),1:end-1));
predict_data5 = predict(cross_data.Trained{5}, data(test(cv, 5),1:end-1));
%to determine whether the predictions are correct or not
result_data1 = confusionmat(cross_data.Y(test(cv, 1)), predict_data1);
result_data2 = confusionmat(cross_data.Y(test(cv, 2)), predict_data2);
result_data3 = confusionmat(cross_data.Y(test(cv, 3)), predict_data3);
result_data4 = confusionmat(cross_data.Y(test(cv, 4)), predict_data4);
result_data5 = confusionmat(cross_data.Y(test(cv, 5)), predict_data5);
accuracy1 = (result_data1(1, 1) + result_data1(2, 2))/(result_data1(1, 2) + result_data1(2, 1) + result_data1(1, 1) + result_data1(2, 2));
accuracy2 = (result_data2(1, 1) + result_data2(2, 2))/(result_data2(1, 2) + result_data2(2, 1) + result_data2(1, 1) + result_data2(2, 2));
accuracy3 = (result_data3(1, 1) + result_data3(2, 2))/(result_data3(1, 2) + result_data3(2, 1) + result_data3(1, 1) + result_data3(2, 2));
accuracy4 = (result_data4(1, 1) + result_data4(2, 2))/(result_data4(1, 2) + result_data4(2, 1) + result_data4(1, 1) + result_data4(2, 2));
accuracy5 = (result_data5(1, 1) + result_data5(2, 2))/(result_data5(1, 2) + result_data5(2, 1) + result_data5(1, 1) + result_data5(2, 2));

%writting the result in excel file
xlswrite('result.xlsx', ["KNN1" accuracy1], 'A1:B1')
xlswrite('result.xlsx', ["KNN2" accuracy2], 'A2:B2')
xlswrite('result.xlsx', ["KNN3" accuracy3], 'A3:B3')
xlswrite('result.xlsx', ["KNN4" accuracy4], 'A4:B4')
xlswrite('result.xlsx', ["KNN5" accuracy5], 'A5:B5')

%bar plot
bar(categorical({'KNN1' 'KNN2' 'KNN3' 'KNN4' 'KNN5'}), [accuracy1 accuracy2 accuracy3 accuracy4 accuracy5])